"use strict";

exports.__esModule = true;
exports.Person = void 0;

var _schemaInspector = _interopRequireDefault(require("schema-inspector"));

var _profile = require("../profile");

var _profileTokens = require("../profileTokens");

var _personLegacy = require("./personLegacy");

var _personUtils = require("./personUtils");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const schemaDefinition = {
  type: 'object',
  strict: false,
  properties: {
    '@context': {
      type: 'string',
      optional: true
    },
    '@type': {
      type: 'string'
    },
    '@id': {
      type: 'string',
      optional: true
    },
    name: {
      type: 'string',
      optional: true
    },
    givenName: {
      type: 'string',
      optional: true
    },
    familyName: {
      type: 'string',
      optional: true
    },
    description: {
      type: 'string',
      optional: true
    },
    image: {
      type: 'array',
      optional: true,
      items: {
        type: 'object',
        properties: {
          '@type': {
            type: 'string'
          },
          name: {
            type: 'string',
            optional: true
          },
          contentUrl: {
            type: 'string',
            optional: true
          }
        }
      }
    },
    website: {
      type: 'array',
      optional: true,
      items: {
        type: 'object',
        properties: {
          '@type': {
            type: 'string'
          },
          url: {
            type: 'string',
            optional: true
          }
        }
      }
    },
    account: {
      type: 'array',
      optional: true,
      items: {
        type: 'object',
        properties: {
          '@type': {
            type: 'string'
          },
          service: {
            type: 'string',
            optional: true
          },
          identifier: {
            type: 'string',
            optional: true
          },
          proofType: {
            type: 'string',
            optional: true
          },
          proofUrl: {
            type: 'string',
            optional: true
          },
          proofMessage: {
            type: 'string',
            optional: true
          },
          proofSignature: {
            type: 'string',
            optional: true
          }
        }
      }
    },
    worksFor: {
      type: 'array',
      optional: true,
      items: {
        type: 'object',
        properties: {
          '@type': {
            type: 'string'
          },
          '@id': {
            type: 'string',
            optional: true
          }
        }
      }
    },
    knows: {
      type: 'array',
      optional: true,
      items: {
        type: 'object',
        properties: {
          '@type': {
            type: 'string'
          },
          '@id': {
            type: 'string',
            optional: true
          }
        }
      }
    },
    address: {
      type: 'object',
      optional: true,
      properties: {
        '@type': {
          type: 'string'
        },
        streetAddress: {
          type: 'string',
          optional: true
        },
        addressLocality: {
          type: 'string',
          optional: true
        },
        postalCode: {
          type: 'string',
          optional: true
        },
        addressCountry: {
          type: 'string',
          optional: true
        }
      }
    },
    birthDate: {
      type: 'string',
      optional: true
    },
    taxID: {
      type: 'string',
      optional: true
    }
  }
};

class Person extends _profile.Profile {
  constructor(profile = {}) {
    super(profile);
    this._profile = Object.assign({}, {
      '@type': 'Person'
    }, this._profile);
  }

  static validateSchema(profile, strict = false) {
    schemaDefinition.strict = strict;
    return _schemaInspector.default.validate(schemaDefinition, profile);
  }

  static fromToken(token, publicKeyOrAddress = null) {
    const profile = (0, _profileTokens.extractProfile)(token, publicKeyOrAddress);
    return new Person(profile);
  }

  static fromLegacyFormat(legacyProfile) {
    const profile = (0, _personLegacy.getPersonFromLegacyFormat)(legacyProfile);
    return new Person(profile);
  }

  toJSON() {
    return {
      profile: this.profile(),
      name: this.name(),
      givenName: this.givenName(),
      familyName: this.familyName(),
      description: this.description(),
      avatarUrl: this.avatarUrl(),
      verifiedAccounts: this.verifiedAccounts(),
      address: this.address(),
      birthDate: this.birthDate(),
      connections: this.connections(),
      organizations: this.organizations()
    };
  }

  profile() {
    return Object.assign({}, this._profile);
  }

  name() {
    return (0, _personUtils.getName)(this.profile());
  }

  givenName() {
    return (0, _personUtils.getGivenName)(this.profile());
  }

  familyName() {
    return (0, _personUtils.getFamilyName)(this.profile());
  }

  description() {
    return (0, _personUtils.getDescription)(this.profile());
  }

  avatarUrl() {
    return (0, _personUtils.getAvatarUrl)(this.profile());
  }

  verifiedAccounts(verifications) {
    return (0, _personUtils.getVerifiedAccounts)(this.profile(), verifications);
  }

  address() {
    return (0, _personUtils.getAddress)(this.profile());
  }

  birthDate() {
    return (0, _personUtils.getBirthDate)(this.profile());
  }

  connections() {
    return (0, _personUtils.getConnections)(this.profile());
  }

  organizations() {
    return (0, _personUtils.getOrganizations)(this.profile());
  }

}

exports.Person = Person;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wcm9maWxlcy9wcm9maWxlU2NoZW1hcy9wZXJzb24uanMiXSwibmFtZXMiOlsic2NoZW1hRGVmaW5pdGlvbiIsInR5cGUiLCJzdHJpY3QiLCJwcm9wZXJ0aWVzIiwib3B0aW9uYWwiLCJuYW1lIiwiZ2l2ZW5OYW1lIiwiZmFtaWx5TmFtZSIsImRlc2NyaXB0aW9uIiwiaW1hZ2UiLCJpdGVtcyIsImNvbnRlbnRVcmwiLCJ3ZWJzaXRlIiwidXJsIiwiYWNjb3VudCIsInNlcnZpY2UiLCJpZGVudGlmaWVyIiwicHJvb2ZUeXBlIiwicHJvb2ZVcmwiLCJwcm9vZk1lc3NhZ2UiLCJwcm9vZlNpZ25hdHVyZSIsIndvcmtzRm9yIiwia25vd3MiLCJhZGRyZXNzIiwic3RyZWV0QWRkcmVzcyIsImFkZHJlc3NMb2NhbGl0eSIsInBvc3RhbENvZGUiLCJhZGRyZXNzQ291bnRyeSIsImJpcnRoRGF0ZSIsInRheElEIiwiUGVyc29uIiwiUHJvZmlsZSIsImNvbnN0cnVjdG9yIiwicHJvZmlsZSIsIl9wcm9maWxlIiwiT2JqZWN0IiwiYXNzaWduIiwidmFsaWRhdGVTY2hlbWEiLCJpbnNwZWN0b3IiLCJ2YWxpZGF0ZSIsImZyb21Ub2tlbiIsInRva2VuIiwicHVibGljS2V5T3JBZGRyZXNzIiwiZnJvbUxlZ2FjeUZvcm1hdCIsImxlZ2FjeVByb2ZpbGUiLCJ0b0pTT04iLCJhdmF0YXJVcmwiLCJ2ZXJpZmllZEFjY291bnRzIiwiY29ubmVjdGlvbnMiLCJvcmdhbml6YXRpb25zIiwidmVyaWZpY2F0aW9ucyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQU1BLE1BQU1BLGdCQUFnQixHQUFHO0FBQ3ZCQyxFQUFBQSxJQUFJLEVBQUUsUUFEaUI7QUFFdkJDLEVBQUFBLE1BQU0sRUFBRSxLQUZlO0FBR3ZCQyxFQUFBQSxVQUFVLEVBQUU7QUFDVixnQkFBWTtBQUFFRixNQUFBQSxJQUFJLEVBQUUsUUFBUjtB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O0FBRUR6QixFQUFBQSxXQUFXLEdBQUc7QUFDWixXQUFPLGlDQUFlLEtBQUt5QixPQUFMLEVBQWYsQ0FBUDtBQUNEOztBQUVEYSxFQUFBQSxTQUFTLEdBQUc7QUFDVixXQUFPLCtCQUFhLEtBQUtiLE9BQUwsRUFBYixDQUFQO0FBQ0Q7O0FBRURjLEVBQUFBLGdCQUFnQixDQUFDRyxhQUFELEVBQWdCO0FBQzlCLFdBQU8sc0NBQW9CLEtBQUtqQixPQUFMLEVBQXBCLEVBQW9DaUIsYUFBcEMsQ0FBUDtBQUNEOztBQUVEM0IsRUFBQUEsT0FBTyxHQUFHO0FBQ1IsV0FBTyw2QkFBVyxLQUFLVSxPQUFMLEVBQVgsQ0FBUDtBQUNEOztBQUVETCxFQUFBQSxTQUFTLEdBQUc7QUFDVixXQUFPLCtCQUFhLEtBQUtLLE9BQUwsRUFBYixDQUFQO0FBQ0Q7O0FBRURlLEVBQUFBLFdBQVcsR0FBRztBQUNaLFdBQU8saUNBQWUsS0FBS2YsT0FBTCxFQUFmLENBQVA7QUFDRDs7QUFFRGdCLEVBQUFBLGFBQWEsR0FBRztBQUNkLFdBQU8sbUNBQWlCLEtBQUtoQixPQUFMLEVBQWpCLENBQVA7QUFDRDs7QUFqRmlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGluc3BlY3RvciBmcm9tICdzY2hlbWEtaW5zcGVjdG9yJ1xuXG5pbXBvcnQgeyBQcm9maWxlIH0gZnJvbSAnLi4vcHJvZmlsZSdcbmltcG9ydCB7IGV4dHJhY3RQcm9maWxlIH0gZnJvbSAnLi4vcHJvZmlsZVRva2VucydcbmltcG9ydCB7IGdldFBlcnNvbkZyb21MZWdhY3lGb3JtYXQgfSBmcm9tICcuL3BlcnNvbkxlZ2FjeSdcbmltcG9ydCB7XG4gIGdldE5hbWUsIGdldEZhbWlseU5hbWUsIGdldEdpdmVuTmFtZSwgZ2V0QXZhdGFyVXJsLCBnZXREZXNjcmlwdGlvbixcbiAgZ2V0VmVyaWZpZWRBY2NvdW50cywgZ2V0QWRkcmVzcywgZ2V0QmlydGhEYXRlLFxuICBnZXRDb25uZWN0aW9ucywgZ2V0T3JnYW5pemF0aW9uc1xufSBmcm9tICcuL3BlcnNvblV0aWxzJ1xuXG5jb25zdCBzY2hlbWFEZWZpbml0aW9uID0ge1xuICB0eXBlOiAnb2JqZWN0JyxcbiAgc3RyaWN0OiBmYWxzZSxcbiAgcHJvcGVydGllczoge1xuICAgICdAY29udGV4dCc6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgJ0B0eXBlJzogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICdAaWQnOiB7IHR5cGU6ICdzdHJpbmcnLCBvcHRpb25hbDogdHJ1ZSB9LFxuICAgIG5hbWU6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgZ2l2ZW5OYW1lOiB7IHR5cGU6ICdzdHJpbmcnLCBvcHRpb25hbDogdHJ1ZSB9LFxuICAgIGZhbWlseU5hbWU6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgZGVzY3JpcHRpb246IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgaW1hZ2U6IHtcbiAgICAgIHR5cGU6ICdhcnJheScsXG4gICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgIGl0ZW1zOiB7XG4gICAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgJ0B0eXBlJzogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgIG5hbWU6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgICAgICAgY29udGVudFVybDogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICB3ZWJzaXRlOiB7XG4gICAgICB0eXBlOiAnYXJyYXknLFxuICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICBpdGVtczoge1xuICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICdAdHlwZSc6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICB1cmw6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgYWNjb3VudDoge1xuICAgICAgdHlwZTogJ2FycmF5JyxcbiAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgaXRlbXM6IHtcbiAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAnQHR5cGUnOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgc2VydmljZTogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfSxcbiAgICAgICAgICBpZGVudGlmaWVyOiB7IHR5cGU6ICdzdHJpbmcnLCBvcHRpb25hbDogdHJ1ZSB9LFxuICAgICAgICAgIHByb29mVHlwZTogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfSxcbiAgICAgICAgICBwcm9vZlVybDogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfSxcbiAgICAgICAgICBwcm9vZk1lc3NhZ2U6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgICAgICAgcHJvb2ZTaWduYXR1cmU6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgd29ya3NGb3I6IHtcbiAgICAgIHR5cGU6ICdhcnJheScsXG4gICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgIGl0ZW1zOiB7XG4gICAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgJ0B0eXBlJzogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICdAaWQnOiB7IHR5cGU6ICdzdHJpbmcnLCBvcHRpb25hbDogdHJ1ZSB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGtub3dzOiB7XG4gICAgICB0eXBlOiAnYXJyYXknLFxuICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICBpdGVtczoge1xuICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICdAdHlwZSc6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAnQGlkJzogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhZGRyZXNzOiB7XG4gICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAnQHR5cGUnOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgIHN0cmVldEFkZHJlc3M6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH0sXG4gICAgICAgIGFkZHJlc3NMb2NhbGl0eTogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfSxcbiAgICAgICAgcG9zdGFsQ29kZTogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfSxcbiAgICAgICAgYWRkcmVzc0NvdW50cnk6IHsgdHlwZTogJ3N0cmluZycsIG9wdGlvbmFsOiB0cnVlIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGJpcnRoRGF0ZTogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfSxcbiAgICB0YXhJRDogeyB0eXBlOiAnc3RyaW5nJywgb3B0aW9uYWw6IHRydWUgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQZXJzb24gZXh0ZW5kcyBQcm9maWxlIHtcbiAgY29uc3RydWN0b3IocHJvZmlsZSA9IHt9KSB7XG4gICAgc3VwZXIocHJvZmlsZSlcbiAgICB0aGlzLl9wcm9maWxlID0gT2JqZWN0LmFzc2lnbih7fSwge1xuICAgICAgJ0B0eXBlJzogJ1BlcnNvbidcbiAgICB9LCB0aGlzLl9wcm9maWxlKVxuICB9XG5cbiAgc3RhdGljIHZhbGlkYXRlU2NoZW1hKHByb2ZpbGUsIHN0cmljdCA9IGZhbHNlKSB7XG4gICAgc2NoZW1hRGVmaW5pdGlvbi5zdHJpY3QgPSBzdHJpY3RcbiAgICByZXR1cm4gaW5zcGVjdG9yLnZhbGlkYXRlKHNjaGVtYURlZmluaXRpb24sIHByb2ZpbGUpXG4gIH1cblxuICBzdGF0aWMgZnJvbVRva2VuKHRva2VuLCBwdWJsaWNLZXlPckFkZHJlc3MgPSBudWxsKSB7XG4gICAgY29uc3QgcHJvZmlsZSA9IGV4dHJhY3RQcm9maWxlKHRva2VuLCBwdWJsaWNLZXlPckFkZHJlc3MpXG4gICAgcmV0dXJuIG5ldyBQZXJzb24ocHJvZmlsZSlcbiAgfVxuXG4gIHN0YXRpYyBmcm9tTGVnYWN5Rm9ybWF0KGxlZ2FjeVByb2ZpbGUpIHtcbiAgICBjb25zdCBwcm9maWxlID0gZ2V0UGVyc29uRnJvbUxlZ2FjeUZvcm1hdChsZWdhY3lQcm9maWxlKVxuICAgIHJldHVybiBuZXcgUGVyc29uKHByb2ZpbGUpXG4gIH1cblxuICB0b0pTT04oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHByb2ZpbGU6IHRoaXMucHJvZmlsZSgpLFxuICAgICAgbmFtZTogdGhpcy5uYW1lKCksXG4gICAgICBnaXZlbk5hbWU6IHRoaXMuZ2l2ZW5OYW1lKCksXG4gICAgICBmYW1pbHlOYW1lOiB0aGlzLmZhbWlseU5hbWUoKSxcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uKCksXG4gICAgICBhdmF0YXJVcmw6IHRoaXMuYXZhdGFyVXJsKCksXG4gICAgICB2ZXJpZmllZEFjY291bnRzOiB0aGlzLnZlcmlmaWVkQWNjb3VudHMoKSxcbiAgICAgIGFkZHJlc3M6IHRoaXMuYWRkcmVzcygpLFxuICAgICAgYmlydGhEYXRlOiB0aGlzLmJpcnRoRGF0ZSgpLFxuICAgICAgY29ubmVjdGlvbnM6IHRoaXMuY29ubmVjdGlvbnMoKSxcbiAgICAgIG9yZ2FuaXphdGlvbnM6IHRoaXMub3JnYW5pemF0aW9ucygpXG4gICAgfVxuICB9XG5cbiAgcHJvZmlsZSgpIHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5fcHJvZmlsZSlcbiAgfVxuXG4gIG5hbWUoKSB7XG4gICAgcmV0dXJuIGdldE5hbWUodGhpcy5wcm9maWxlKCkpXG4gIH1cblxuICBnaXZlbk5hbWUoKSB7XG4gICAgcmV0dXJuIGdldEdpdmVuTmFtZSh0aGlzLnByb2ZpbGUoKSlcbiAgfVxuXG4gIGZhbWlseU5hbWUoKSB7XG4gICAgcmV0dXJuIGdldEZhbWlseU5hbWUodGhpcy5wcm9maWxlKCkpXG4gIH1cblxuICBkZXNjcmlwdGlvbigpIHtcbiAgICByZXR1cm4gZ2V0RGVzY3JpcHRpb24odGhpcy5wcm9maWxlKCkpXG4gIH1cblxuICBhdmF0YXJVcmwoKSB7XG4gICAgcmV0dXJuIGdldEF2YXRhclVybCh0aGlzLnByb2ZpbGUoKSlcbiAgfVxuXG4gIHZlcmlmaWVkQWNjb3VudHModmVyaWZpY2F0aW9ucykge1xuICAgIHJldHVybiBnZXRWZXJpZmllZEFjY291bnRzKHRoaXMucHJvZmlsZSgpLCB2ZXJpZmljYXRpb25zKVxuICB9XG5cbiAgYWRkcmVzcygpIHtcbiAgICByZXR1cm4gZ2V0QWRkcmVzcyh0aGlzLnByb2ZpbGUoKSlcbiAgfVxuXG4gIGJpcnRoRGF0ZSgpIHtcbiAgICByZXR1cm4gZ2V0QmlydGhEYXRlKHRoaXMucHJvZmlsZSgpKVxuICB9XG5cbiAgY29ubmVjdGlvbnMoKSB7XG4gICAgcmV0dXJuIGdldENvbm5lY3Rpb25zKHRoaXMucHJvZmlsZSgpKVxuICB9XG5cbiAgb3JnYW5pemF0aW9ucygpIHtcbiAgICByZXR1cm4gZ2V0T3JnYW5pemF0aW9ucyh0aGlzLnByb2ZpbGUoKSlcbiAgfVxufVxuIl19