"use strict";

exports.__esModule = true;
exports.getName = getName;
exports.getGivenName = getGivenName;
exports.getFamilyName = getFamilyName;
exports.getDescription = getDescription;
exports.getAvatarUrl = getAvatarUrl;
exports.getVerifiedAccounts = getVerifiedAccounts;
exports.getOrganizations = getOrganizations;
exports.getConnections = getConnections;
exports.getAddress = getAddress;
exports.getBirthDate = getBirthDate;

function getName(profile) {
  if (!profile) {
    return null;
  }

  let name = null;

  if (profile.name) {
    name = profile.name;
  } else if (profile.givenName || profile.familyName) {
    name = '';

    if (profile.givenName) {
      name = profile.givenName;
    }

    if (profile.familyName) {
      name += ` ${profile.familyName}`;
    }
  }

  return name;
}

function getGivenName(profile) {
  if (!profile) {
    return null;
  }

  let givenName = null;

  if (profile.givenName) {
    givenName = profile.givenName;
  } else if (profile.name) {
    const nameParts = profile.name.split(' ');
    givenName = nameParts.slice(0, -1).join(' ');
  }

  return givenName;
}

function getFamilyName(profile) {
  if (!profile) {
    return null;
  }

  let familyName = null;

  if (profile.familyName) {
    familyName = profile.familyName;
  } else if (profile.name) {
    const nameParts = profile.name.split(' ');
    familyName = nameParts.pop();
  }

  return familyName;
}

function getDescription(profile) {
  if (!profile) {
    return null;
  }

  let description = null;

  if (profile.description) {
    description = profile.description;
  }

  return description;
}

function getAvatarUrl(profile) {
  if (!profile) {
    return null;
  }

  let avatarContentUrl = null;

  if (profile.image) {
    profile.image.map(image => {
      if (image.name === 'avatar') {
        avatarContentUrl = image.contentUrl;
        return avatarContentUrl;
      } else {
        return null;
      }
    });
  }

  return avatarContentUrl;
}

function getVerifiedAccounts(profile, verifications) {
  if (!profile) {
    return null;
  }

  const filteredAccounts = [];

  if (profile.hasOwnProperty('account') && verifications) {
    profile.account.map(account => {
      let accountIsValid = false;
      let proofUrl = null;
      verifications.map(verification => {
        if (verification.hasOwnProperty('proof_url')) {
          verification.proofUrl = verification.proof_url;
        }

        if (verification.valid && verification.service === account.service && verification.identifier === account.identifier && verification.proofUrl) {
          accountIsValid = true;
          proofUrl = verification.proofUrl;
          return true;
        } else {
          return false;
        }
      });

      if (accountIsValid) {
        account.proofUrl = proofUrl;
        filteredAccounts.push(account);
        return account;
      } else {
        return null;
      }
    });
  }

  return filteredAccounts;
}

function getOrganizations(profile) {
  if (!profile) {
    return null;
  }

  const organizations = [];

  if (profile.hasOwnProperty('worksFor')) {
    return profile.worksFor;
  }

  return organizations;
}

function getConnections(profile) {
  if (!profile) {
    return null;
  }

  let connections = [];

  if (profile.hasOwnProperty('knows')) {
    connections = profile.knows;
  }

  return connections;
}

function getAddress(profile) {
  if (!profile) {
    return null;
  }

  let addressString = null;

  if (profile.hasOwnProperty('address')) {
    const addressParts = [];

    if (profile.address.hasOwnProperty('streetAddress')) {
      addressParts.push(profile.address.streetAddress);
    }

    if (profile.address.hasOwnProperty('addressLocality')) {
      addressParts.push(profile.address.addressLocality);
    }

    if (profile.address.hasOwnProperty('postalCode')) {
      addressParts.push(profile.address.postalCode);
    }

    if (profile.address.hasOwnProperty('addressCountry')) {
      addressParts.push(profile.address.addressCountry);
    }

    if (addressParts.length) {
      addressString = addressParts.join(', ');
    }
  }

  return addressString;
}

function getBirthDate(profile) {
  if (!profile) {
    return null;
  }

  const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  let birthDateString = null;

  if (profile.hasOwnProperty('birthDate')) {
    const date = new Date(profile.birthDate);
    birthDateString = `${monthNames[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
  }

  return birthDateString;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wcm9maWxlcy9wcm9maWxlU2NoZW1hcy9wZXJzb25VdGlscy5qcyJdLCJuYW1lcyI6WyJnZXROYW1lIiwicHJvZmlsZSIsIm5hbWUiLCJnaXZlbk5hbWUiLCJmYW1pbHlOYW1lIiwiZ2V0R2l2ZW5OYW1lIiwibmFtZVBhcnRzIiwic3BsaXQiLCJzbGljZSIsImpvaW4iLCJnZXRGYW1pbHlOYW1lIiwicG9wIiwiZ2V0RGVzY3JpcHRpb24iLCJkZXNjcmlwdGlvbiIsImdldEF2YXRhclVybCIsImF2YXRhckNvbnRlbnRVcmwiLCJpbWFnZSIsIm1hcCIsImNvbnRlbnRVcmwiLCJnZXRWZXJpZmllZEFjY291bnRzIiwidmVyaWZpY2F0aW9ucyIsImZpbHRlcmVkQWNjb3VudHMiLCJoYXNPd25Qcm9wZXJ0eSIsImFjY291bnQiLCJhY2NvdW50SXNWYWxpZCIsInByb29mVXJsIiwidmVyaWZpY2F0aW9uIiwicHJvb2ZfdXJsIiwidmFsaWQiLCJzZXJ2aWNlIiwiaWRlbnRpZmllciIsInB1c2giLCJnZXRPcmdhbml6YXRpb25zIiwib3JnYW5pemF0aW9ucyIsIndvcmtzRm9yIiwiZ2V0Q29ubmVjdGlvbnMiLCJjb25uZWN0aW9ucyIsImtub3dzIiwiZ2V0QWRkcmVzcyIsImFkZHJlc3NTdHJpbmciLCJhZGRyZXNzUGFydHMiLCJhZGRyZXNzIiwic3RyZWV0QWRkcmVzcyIsImFkZHJlc3NMb2NhbGl0eSIsInBvc3RhbENvZGUiLCJhZGRyZXNzQ291bnRyeSIsImxlbmd0aCIsImdldEJpcnRoRGF0ZSIsIm1vbnRoTmFtZXMiLCJiaXJ0aERhdGVTdHJpbmciLCJkYXRlIiwiRGF0ZSIsImJpcnRoRGF0ZSIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldEZ1bGxZZWFyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFPLFNBQVNBLE9BQVQsQ0FBaUJDLE9BQWpCLEVBQTBCO0FBQy9CLE1BQUksQ0FBQ0EsT0FBTCxFQUFjO0FBQ1osV0FBTyxJ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LElBQUksQ0FBQ0csUUFBTCxFQUFELENBQWtCLElBQUdILElBQUksQ0FBQ0ksT0FBTCxFQUFlLEtBQUlKLElBQUksQ0FBQ0ssV0FBTCxFQUFtQixFQUExRjtBQUNEOztBQUVELFNBQU9OLGVBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBnZXROYW1lKHByb2ZpbGUpIHtcbiAgaWYgKCFwcm9maWxlKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGxldCBuYW1lID0gbnVsbFxuICBpZiAocHJvZmlsZS5uYW1lKSB7XG4gICAgbmFtZSA9IHByb2ZpbGUubmFtZVxuICB9IGVsc2UgaWYgKHByb2ZpbGUuZ2l2ZW5OYW1lIHx8IHByb2ZpbGUuZmFtaWx5TmFtZSkge1xuICAgIG5hbWUgPSAnJ1xuICAgIGlmIChwcm9maWxlLmdpdmVuTmFtZSkge1xuICAgICAgbmFtZSA9IHByb2ZpbGUuZ2l2ZW5OYW1lXG4gICAgfVxuICAgIGlmIChwcm9maWxlLmZhbWlseU5hbWUpIHtcbiAgICAgIG5hbWUgKz0gYCAke3Byb2ZpbGUuZmFtaWx5TmFtZX1gXG4gICAgfVxuICB9XG4gIHJldHVybiBuYW1lXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRHaXZlbk5hbWUocHJvZmlsZSkge1xuICBpZiAoIXByb2ZpbGUpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgbGV0IGdpdmVuTmFtZSA9IG51bGxcbiAgaWYgKHByb2ZpbGUuZ2l2ZW5OYW1lKSB7XG4gICAgZ2l2ZW5OYW1lID0gcHJvZmlsZS5naXZlbk5hbWVcbiAgfSBlbHNlIGlmIChwcm9maWxlLm5hbWUpIHtcbiAgICBjb25zdCBuYW1lUGFydHMgPSBwcm9maWxlLm5hbWUuc3BsaXQoJyAnKVxuICAgIGdpdmVuTmFtZSA9IG5hbWVQYXJ0cy5zbGljZSgwLCAtMSkuam9pbignICcpXG4gIH1cbiAgcmV0dXJuIGdpdmVuTmFtZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmFtaWx5TmFtZShwcm9maWxlKSB7XG4gIGlmICghcHJvZmlsZSkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBsZXQgZmFtaWx5TmFtZSA9IG51bGxcbiAgaWYgKHByb2ZpbGUuZmFtaWx5TmFtZSkge1xuICAgIGZhbWlseU5hbWUgPSBwcm9maWxlLmZhbWlseU5hbWVcbiAgfSBlbHNlIGlmIChwcm9maWxlLm5hbWUpIHtcbiAgICBjb25zdCBuYW1lUGFydHMgPSBwcm9maWxlLm5hbWUuc3BsaXQoJyAnKVxuICAgIGZhbWlseU5hbWUgPSBuYW1lUGFydHMucG9wKClcbiAgfVxuICByZXR1cm4gZmFtaWx5TmFtZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVzY3JpcHRpb24ocHJvZmlsZSkge1xuICBpZiAoIXByb2ZpbGUpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgbGV0IGRlc2NyaXB0aW9uID0gbnVsbFxuICBpZiAocHJvZmlsZS5kZXNjcmlwdGlvbikge1xuICAgIGRlc2NyaXB0aW9uID0gcHJvZmlsZS5kZXNjcmlwdGlvblxuICB9XG4gIHJldHVybiBkZXNjcmlwdGlvblxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXZhdGFyVXJsKHByb2ZpbGUpIHtcbiAgaWYgKCFwcm9maWxlKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGxldCBhdmF0YXJDb250ZW50VXJsID0gbnVsbFxuICBpZiAocHJvZmlsZS5pbWFnZSkge1xuICAgIHByb2ZpbGUuaW1hZ2UubWFwKChpbWFnZSkgPT4ge1xuICAgICAgaWYgKGltYWdlLm5hbWUgPT09ICdhdmF0YXInKSB7XG4gICAgICAgIGF2YXRhckNvbnRlbnRVcmwgPSBpbWFnZS5jb250ZW50VXJsXG4gICAgICAgIHJldHVybiBhdmF0YXJDb250ZW50VXJsXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuICAgIH0pXG4gIH1cbiAgcmV0dXJuIGF2YXRhckNvbnRlbnRVcmxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFZlcmlmaWVkQWNjb3VudHMocHJvZmlsZSwgdmVyaWZpY2F0aW9ucykge1xuICBpZiAoIXByb2ZpbGUpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgY29uc3QgZmlsdGVyZWRBY2NvdW50cyA9IFtdXG4gIGlmIChwcm9maWxlLmhhc093blByb3BlcnR5KCdhY2NvdW50JykgJiYgdmVyaWZpY2F0aW9ucykge1xuICAgIHByb2ZpbGUuYWNjb3VudC5tYXAoKGFjY291bnQpID0+IHtcbiAgICAgIGxldCBhY2NvdW50SXNWYWxpZCA9IGZhbHNlXG4gICAgICBsZXQgcHJvb2ZVcmwgPSBudWxsXG5cbiAgICAgIHZlcmlmaWNhdGlvbnMubWFwKCh2ZXJpZmljYXRpb24pID0+IHtcbiAgICAgICAgaWYgKHZlcmlmaWNhdGlvbi5oYXNPd25Qcm9wZXJ0eSgncHJvb2ZfdXJsJykpIHtcbiAgICAgICAgICB2ZXJpZmljYXRpb24ucHJvb2ZVcmwgPSB2ZXJpZmljYXRpb24ucHJvb2ZfdXJsXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZlcmlmaWNhdGlvbi52YWxpZFxuICAgICAgICAgICAgJiYgdmVyaWZpY2F0aW9uLnNlcnZpY2UgPT09IGFjY291bnQuc2VydmljZVxuICAgICAgICAgICAgJiYgdmVyaWZpY2F0aW9uLmlkZW50aWZpZXIgPT09IGFjY291bnQuaWRlbnRpZmllclxuICAgICAgICAgICAgJiYgdmVyaWZpY2F0aW9uLnByb29mVXJsKSB7XG4gICAgICAgICAgYWNjb3VudElzVmFsaWQgPSB0cnVlXG4gICAgICAgICAgcHJvb2ZVcmwgPSB2ZXJpZmljYXRpb24ucHJvb2ZVcmxcbiAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBpZiAoYWNjb3VudElzVmFsaWQpIHtcbiAgICAgICAgYWNjb3VudC5wcm9vZlVybCA9IHByb29mVXJsXG4gICAgICAgIGZpbHRlcmVkQWNjb3VudHMucHVzaChhY2NvdW50KVxuICAgICAgICByZXR1cm4gYWNjb3VudFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cbiAgICB9KVxuICB9XG4gIHJldHVybiBmaWx0ZXJlZEFjY291bnRzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPcmdhbml6YXRpb25zKHByb2ZpbGUpIHtcbiAgaWYgKCFwcm9maWxlKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGNvbnN0IG9yZ2FuaXphdGlvbnMgPSBbXVxuXG4gIGlmIChwcm9maWxlLmhhc093blByb3BlcnR5KCd3b3Jrc0ZvcicpKSB7XG4gICAgcmV0dXJuIHByb2ZpbGUud29ya3NGb3JcbiAgfVxuXG4gIHJldHVybiBvcmdhbml6YXRpb25zXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb25uZWN0aW9ucyhwcm9maWxlKSB7XG4gIGlmICghcHJvZmlsZSkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBsZXQgY29ubmVjdGlvbnMgPSBbXVxuXG4gIGlmIChwcm9maWxlLmhhc093blByb3BlcnR5KCdrbm93cycpKSB7XG4gICAgY29ubmVjdGlvbnMgPSBwcm9maWxlLmtub3dzXG4gIH1cblxuICByZXR1cm4gY29ubmVjdGlvbnNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFkZHJlc3MocHJvZmlsZSkge1xuICBpZiAoIXByb2ZpbGUpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgbGV0IGFkZHJlc3NTdHJpbmcgPSBudWxsXG5cbiAgaWYgKHByb2ZpbGUuaGFzT3duUHJvcGVydHkoJ2FkZHJlc3MnKSkge1xuICAgIGNvbnN0IGFkZHJlc3NQYXJ0cyA9IFtdXG5cbiAgICBpZiAocHJvZmlsZS5hZGRyZXNzLmhhc093blByb3BlcnR5KCdzdHJlZXRBZGRyZXNzJykpIHtcbiAgICAgIGFkZHJlc3NQYXJ0cy5wdXNoKHByb2ZpbGUuYWRkcmVzcy5zdHJlZXRBZGRyZXNzKVxuICAgIH1cbiAgICBpZiAocHJvZmlsZS5hZGRyZXNzLmhhc093blByb3BlcnR5KCdhZGRyZXNzTG9jYWxpdHknKSkge1xuICAgICAgYWRkcmVzc1BhcnRzLnB1c2gocHJvZmlsZS5hZGRyZXNzLmFkZHJlc3NMb2NhbGl0eSlcbiAgICB9XG4gICAgaWYgKHByb2ZpbGUuYWRkcmVzcy5oYXNPd25Qcm9wZXJ0eSgncG9zdGFsQ29kZScpKSB7XG4gICAgICBhZGRyZXNzUGFydHMucHVzaChwcm9maWxlLmFkZHJlc3MucG9zdGFsQ29kZSlcbiAgICB9XG4gICAgaWYgKHByb2ZpbGUuYWRkcmVzcy5oYXNPd25Qcm9wZXJ0eSgnYWRkcmVzc0NvdW50cnknKSkge1xuICAgICAgYWRkcmVzc1BhcnRzLnB1c2gocHJvZmlsZS5hZGRyZXNzLmFkZHJlc3NDb3VudHJ5KVxuICAgIH1cblxuICAgIGlmIChhZGRyZXNzUGFydHMubGVuZ3RoKSB7XG4gICAgICBhZGRyZXNzU3RyaW5nID0gYWRkcmVzc1BhcnRzLmpvaW4oJywgJylcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYWRkcmVzc1N0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmlydGhEYXRlKHByb2ZpbGUpIHtcbiAgaWYgKCFwcm9maWxlKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGNvbnN0IG1vbnRoTmFtZXMgPSBbXG4gICAgJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLFxuICAgICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlcidcbiAgXVxuXG4gIGxldCBiaXJ0aERhdGVTdHJpbmcgPSBudWxsXG5cbiAgaWYgKHByb2ZpbGUuaGFzT3duUHJvcGVydHkoJ2JpcnRoRGF0ZScpKSB7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHByb2ZpbGUuYmlydGhEYXRlKVxuICAgIGJpcnRoRGF0ZVN0cmluZyA9IGAke21vbnRoTmFtZXNbZGF0ZS5nZXRNb250aCgpXX0gJHtkYXRlLmdldERhdGUoKX0sICR7ZGF0ZS5nZXRGdWxsWWVhcigpfWBcbiAgfVxuXG4gIHJldHVybiBiaXJ0aERhdGVTdHJpbmdcbn1cbiJdfQ==