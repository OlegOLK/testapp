"use strict";

exports.__esModule = true;
exports.getPersonFromLegacyFormat = getPersonFromLegacyFormat;

function formatAccount(serviceName, data) {
  let proofUrl;

  if (data.proof && data.proof.url) {
    proofUrl = data.proof.url;
  }

  return {
    '@type': 'Account',
    service: serviceName,
    identifier: data.username,
    proofType: 'http',
    proofUrl
  };
}

function getPersonFromLegacyFormat(profile) {
  const profileData = {
    '@type': 'Person'
  };

  if (profile) {
    if (profile.name && profile.name.formatted) {
      profileData.name = profile.name.formatted;
    }

    if (profile.bio) {
      profileData.description = profile.bio;
    }

    if (profile.location && profile.location.formatted) {
      profileData.address = {
        '@type': 'PostalAddress',
        addressLocality: profile.location.formatted
      };
    }

    const images = [];

    if (profile.avatar && profile.avatar.url) {
      images.push({
        '@type': 'ImageObject',
        name: 'avatar',
        contentUrl: profile.avatar.url
      });
    }

    if (profile.cover && profile.cover.url) {
      images.push({
        '@type': 'ImageObject',
        name: 'cover',
        contentUrl: profile.cover.url
      });
    }

    if (images.length) {
      profileData.image = images;
    }

    if (profile.website) {
      profileData.website = [{
        '@type': 'WebSite',
        url: profile.website
      }];
    }

    const accounts = [];

    if (profile.bitcoin && profile.bitcoin.address) {
      accounts.push({
        '@type': 'Account',
        role: 'payment',
        service: 'bitcoin',
        identifier: profile.bitcoin.address
      });
    }

    if (profile.twitter && profile.twitter.username) {
      accounts.push(formatAccount('twitter', profile.twitter));
    }

    if (profile.facebook && profile.facebook.username) {
      accounts.push(formatAccount('facebook', profile.facebook));
    }

    if (profile.github && profile.github.username) {
      accounts.push(formatAccount('github', profile.github));
    }

    if (profile.auth) {
      if (profile.auth.length > 0) {
        if (profile.auth[0] && profile.auth[0].publicKeychain) {
          accounts.push({
            '@type': 'Account',
            role: 'key',
            service: 'bip32',
            identifier: profile.auth[0].publicKeychain
          });
        }
      }
    }

    if (profile.pgp && profile.pgp.url) {
      accounts.push({
        '@type': 'Account',
        role: 'key',
        service: 'pgp',
        identifier: profile.pgp.fingerprint,
        contentUrl: profile.pgp.url
      });
    }

    profileData.account = accounts;
  }

  return profileData;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wcm9maWxlcy9wcm9maWxlU2NoZW1hcy9wZXJzb25MZWdhY3kuanMiXSwibmFtZXMiOlsiZm9ybWF0QWNjb3VudCIsInNlcnZpY2VOYW1lIiwiZGF0YSIsInByb29mVXJsIiwicHJvb2YiLCJ1cmwiLCJzZXJ2aWNlIiwiaWRlbnRpZmllciIsInVzZXJuYW1lIiwicHJvb2ZUeXBlIiwiZ2V0UGVyc29uRnJvbUxlZ2FjeUZvcm1hdCIsInByb2ZpbGUiLCJwcm9maWxlRGF0YSIsIm5hbWUiLCJmb3JtYXR0ZWQiLCJiaW8iLCJkZXNjcmlwdGlvbiIsImxvY2F0aW9uIiwiYWRkcmVzcyIsImFkZHJlc3NMb2NhbGl0eSIsImltYWdlcyIsImF2YXRhciIsInB1c2giLCJjb250ZW50VXJsIiwiY292ZXIiLCJsZW5ndGgiLCJpbWFnZSIsIndlYnNpdGUiLCJhY2NvdW50cyIsImJpdGNvaW4iLCJyb2xlIiwidHdpdHRlciIsImZhY2Vib29rIiwiZ2l0aHViIiwiYXV0aCIsInB1YmxpY0tleWNoYWluIiwicGdwIiwiZmluZ2VycHJpbnQiLCJhY2NvdW50Il0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLFNBQVNBLGFBQVQsQ0FBdUJDLFdBQXZCLEVBQW9DQyxJQUFwQyxFQUEwQztBQUN4QyxNQUFJQyxRQUFKOztBQUNBLE1BQUlELElBQUksQ0FBQ0UsS0FBTCxJQUFjRixJQUFJLENBQUNFLEtBQUwsQ0FBV0MsR0FBN0IsRUFBa0M7QUFDaENGLElBQUFBLFFBQVEsR0FBR0QsSUFBSSxDQUFDRSxLQUFMLENBQVdDLEdBQXRCO0FBQ0Q7O0FBQ0QsU0FBTztBQUNMLGFBQVMsU0FESjtBQUVMQyxJQUFBQSxPQUFPLEVBQUVMLFdBRko7QUFHTE0sSUFBQUEsVUFBVSxFQUFFTCxJQUFJLENBQUNNLFFBSFo7QUFJTEMsSUFBQUEsU0FBUyxFQUFFLE1BSk47QUFLTE4sSUFBQUE7QUFMSyxHQUFQO0FBT0Q7O0FBRU0sU0FBU08seUJBQVQsQ0FBbUNDLE9BQW5DLEVB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Y2VOYW1lLCBkYXRhKSB7XG4gIGxldCBwcm9vZlVybFxuICBpZiAoZGF0YS5wcm9vZiAmJiBkYXRhLnByb29mLnVybCkge1xuICAgIHByb29mVXJsID0gZGF0YS5wcm9vZi51cmxcbiAgfVxuICByZXR1cm4ge1xuICAgICdAdHlwZSc6ICdBY2NvdW50JyxcbiAgICBzZXJ2aWNlOiBzZXJ2aWNlTmFtZSxcbiAgICBpZGVudGlmaWVyOiBkYXRhLnVzZXJuYW1lLFxuICAgIHByb29mVHlwZTogJ2h0dHAnLFxuICAgIHByb29mVXJsXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBlcnNvbkZyb21MZWdhY3lGb3JtYXQocHJvZmlsZSkge1xuICBjb25zdCBwcm9maWxlRGF0YSA9IHtcbiAgICAnQHR5cGUnOiAnUGVyc29uJ1xuICB9XG5cbiAgaWYgKHByb2ZpbGUpIHtcbiAgICBpZiAocHJvZmlsZS5uYW1lICYmIHByb2ZpbGUubmFtZS5mb3JtYXR0ZWQpIHtcbiAgICAgIHByb2ZpbGVEYXRhLm5hbWUgPSBwcm9maWxlLm5hbWUuZm9ybWF0dGVkXG4gICAgfVxuXG4gICAgaWYgKHByb2ZpbGUuYmlvKSB7XG4gICAgICBwcm9maWxlRGF0YS5kZXNjcmlwdGlvbiA9IHByb2ZpbGUuYmlvXG4gICAgfVxuXG4gICAgaWYgKHByb2ZpbGUubG9jYXRpb24gJiYgcHJvZmlsZS5sb2NhdGlvbi5mb3JtYXR0ZWQpIHtcbiAgICAgIHByb2ZpbGVEYXRhLmFkZHJlc3MgPSB7XG4gICAgICAgICdAdHlwZSc6ICdQb3N0YWxBZGRyZXNzJyxcbiAgICAgICAgYWRkcmVzc0xvY2FsaXR5OiBwcm9maWxlLmxvY2F0aW9uLmZvcm1hdHRlZFxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGltYWdlcyA9IFtdXG4gICAgaWYgKHByb2ZpbGUuYXZhdGFyICYmIHByb2ZpbGUuYXZhdGFyLnVybCkge1xuICAgICAgaW1hZ2VzLnB1c2goe1xuICAgICAgICAnQHR5cGUnOiAnSW1hZ2VPYmplY3QnLFxuICAgICAgICBuYW1lOiAnYXZhdGFyJyxcbiAgICAgICAgY29udGVudFVybDogcHJvZmlsZS5hdmF0YXIudXJsXG4gICAgICB9KVxuICAgIH1cbiAgICBpZiAocHJvZmlsZS5jb3ZlciAmJiBwcm9maWxlLmNvdmVyLnVybCkge1xuICAgICAgaW1hZ2VzLnB1c2goe1xuICAgICAgICAnQHR5cGUnOiAnSW1hZ2VPYmplY3QnLFxuICAgICAgICBuYW1lOiAnY292ZXInLFxuICAgICAgICBjb250ZW50VXJsOiBwcm9maWxlLmNvdmVyLnVybFxuICAgICAgfSlcbiAgICB9XG4gICAgaWYgKGltYWdlcy5sZW5ndGgpIHtcbiAgICAgIHByb2ZpbGVEYXRhLmltYWdlID0gaW1hZ2VzXG4gICAgfVxuXG4gICAgaWYgKHByb2ZpbGUud2Vic2l0ZSkge1xuICAgICAgcHJvZmlsZURhdGEud2Vic2l0ZSA9IFt7XG4gICAgICAgICdAdHlwZSc6ICdXZWJTaXRlJyxcbiAgICAgICAgdXJsOiBwcm9maWxlLndlYnNpdGVcbiAgICAgIH1dXG4gICAgfVxuXG4gICAgY29uc3QgYWNjb3VudHMgPSBbXVxuICAgIGlmIChwcm9maWxlLmJpdGNvaW4gJiYgcHJvZmlsZS5iaXRjb2luLmFkZHJlc3MpIHtcbiAgICAgIGFjY291bnRzLnB1c2goe1xuICAgICAgICAnQHR5cGUnOiAnQWNjb3VudCcsXG4gICAgICAgIHJvbGU6ICdwYXltZW50JyxcbiAgICAgICAgc2VydmljZTogJ2JpdGNvaW4nLFxuICAgICAgICBpZGVudGlmaWVyOiBwcm9maWxlLmJpdGNvaW4uYWRkcmVzc1xuICAgICAgfSlcbiAgICB9XG4gICAgaWYgKHByb2ZpbGUudHdpdHRlciAmJiBwcm9maWxlLnR3aXR0ZXIudXNlcm5hbWUpIHtcbiAgICAgIGFjY291bnRzLnB1c2goZm9ybWF0QWNjb3VudCgndHdpdHRlcicsIHByb2ZpbGUudHdpdHRlcikpXG4gICAgfVxuICAgIGlmIChwcm9maWxlLmZhY2Vib29rICYmIHByb2ZpbGUuZmFjZWJvb2sudXNlcm5hbWUpIHtcbiAgICAgIGFjY291bnRzLnB1c2goZm9ybWF0QWNjb3VudCgnZmFjZWJvb2snLCBwcm9maWxlLmZhY2Vib29rKSlcbiAgICB9XG4gICAgaWYgKHByb2ZpbGUuZ2l0aHViICYmIHByb2ZpbGUuZ2l0aHViLnVzZXJuYW1lKSB7XG4gICAgICBhY2NvdW50cy5wdXNoKGZvcm1hdEFjY291bnQoJ2dpdGh1YicsIHByb2ZpbGUuZ2l0aHViKSlcbiAgICB9XG5cbiAgICBpZiAocHJvZmlsZS5hdXRoKSB7XG4gICAgICBpZiAocHJvZmlsZS5hdXRoLmxlbmd0aCA+IDApIHtcbiAgICAgICAgaWYgKHByb2ZpbGUuYXV0aFswXSAmJiBwcm9maWxlLmF1dGhbMF0ucHVibGljS2V5Y2hhaW4pIHtcbiAgICAgICAgICBhY2NvdW50cy5wdXNoKHtcbiAgICAgICAgICAgICdAdHlwZSc6ICdBY2NvdW50JyxcbiAgICAgICAgICAgIHJvbGU6ICdrZXknLFxuICAgICAgICAgICAgc2VydmljZTogJ2JpcDMyJyxcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IHByb2ZpbGUuYXV0aFswXS5wdWJsaWNLZXljaGFpblxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHByb2ZpbGUucGdwICYmIHByb2ZpbGUucGdwLnVybCkge1xuICAgICAgYWNjb3VudHMucHVzaCh7XG4gICAgICAgICdAdHlwZSc6ICdBY2NvdW50JyxcbiAgICAgICAgcm9sZTogJ2tleScsXG4gICAgICAgIHNlcnZpY2U6ICdwZ3AnLFxuICAgICAgICBpZGVudGlmaWVyOiBwcm9maWxlLnBncC5maW5nZXJwcmludCxcbiAgICAgICAgY29udGVudFVybDogcHJvZmlsZS5wZ3AudXJsXG4gICAgICB9KVxuICAgIH1cblxuICAgIHByb2ZpbGVEYXRhLmFjY291bnQgPSBhY2NvdW50c1xuICB9XG5cbiAgcmV0dXJuIHByb2ZpbGVEYXRhXG59XG4iXX0=